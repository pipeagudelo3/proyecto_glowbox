{% extends "base.html" %}
{% block title %}{{ category.nombre }} · Categorías · Glowbox{% endblock %}

{% block content %}
  <p style="color:var(--muted);margin:0 0 .5rem 0;">
    <a class="und" href="{% url 'catalog:category_list' %}">Categorías</a> › {{ category.nombre }}
  </p>

  <article class="card" style="margin-bottom:18px;">
    <h2 style="margin:0 0 .25rem 0;">{{ category.nombre }}</h2>
    {% if category.descripcion %}
      <p style="margin:.25rem 0 0 0;">{{ category.descripcion }}</p>
    {% else %}
      <p style="margin:.25rem 0 0 0;color:var(--muted);">Sin descripción.</p>
    {% endif %}
  </article>

  {% if products %}
    <div class="grid">
      {% for p in products %}
        <article class="card product-card">
          {% if p.imagen_url %}
            <img src="{{ p.imagen_url }}" alt="{{ p.nombre }}">
          {% endif %}
          <h3 class="card-title">
            <a href="{% url 'catalog:product_detail' p.slug %}">{{ p.nombre }}</a>
          </h3>
          <p>$ {{ p.precio }}</p>
          <form method="post" action="{% url 'cart:add' p.id %}">
            {% csrf_token %}
            <button class="btn btn-primary btn-neon" type="submit">Agregar al carrito</button>
          </form>
        </article>
      {% endfor %}
    </div>

    <div style="margin-top:16px;display:flex;gap:8px;align-items:center;">
      {% if page_obj.has_previous %}
        <a class="btn btn-ghost" href="?page={{ page_obj.previous_page_number }}">« Anterior</a>
      {% endif %}
      <span style="color:var(--muted);">
        Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
      </span>
      {% if page_obj.has_next %}
        <a class="btn btn-ghost" href="?page={{ page_obj.next_page_number }}">Siguiente »</a>
      {% endif %}
    </div>
  {% else %}
    <p>No hay productos activos en esta categoría por ahora.</p>
  {% endif %}
{% endblock %}
